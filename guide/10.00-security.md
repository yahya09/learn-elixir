# Chapter 10: Security

Security is critical for web applications. In this chapter, we'll explore how Phoenix helps you build secure applications and common vulnerabilities to avoid.

## What You'll Learn

- HTTPS and TLS configuration
- CSRF protection
- SQL injection prevention
- XSS (Cross-Site Scripting) prevention
- Security headers
- Common vulnerabilities and mitigations

## Chapter Structure

This chapter covers:

- **10.1 HTTPS and TLS** - Encrypted connections
- **10.2 CSRF Protection** - Preventing cross-site request forgery
- **10.3 SQL Injection Prevention** - Safe database queries
- **10.4 XSS Prevention** - Output encoding and sanitization
- **10.5 Security Headers** - HTTP security headers
- **10.6 Common Vulnerabilities** - OWASP Top 10 and more

## Defense in Depth

Security is layered:

```
┌─────────────────────────────────────────────────────────────┐
│                        Application                           │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                    Phoenix Layer                         │ │
│  │  • CSRF tokens        • Input validation                │ │
│  │  • Output encoding    • Authentication                  │ │
│  │  • Authorization      • Rate limiting                   │ │
│  └─────────────────────────────────────────────────────────┘ │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                     Ecto Layer                          │ │
│  │  • Parameterized queries  • Changesets                  │ │
│  │  • Type casting           • Validations                 │ │
│  └─────────────────────────────────────────────────────────┘ │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                   Database Layer                        │ │
│  │  • Constraints        • Permissions                     │ │
│  │  • Encryption at rest                                   │ │
│  └─────────────────────────────────────────────────────────┘ │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                   Network Layer                         │ │
│  │  • HTTPS/TLS          • Firewalls                       │ │
│  │  • Security headers   • Load balancers                  │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## Phoenix Security Features

Phoenix provides built-in security:

| Feature | Protection Against |
|---------|-------------------|
| CSRF tokens | Cross-site request forgery |
| HEEx escaping | Cross-site scripting (XSS) |
| Ecto queries | SQL injection |
| `put_secure_browser_headers` | Various attacks |
| Content Security Policy | XSS, data injection |
| Secret key base | Session tampering |

## Security Checklist

Before deploying:

- [ ] HTTPS enabled
- [ ] CSRF protection active
- [ ] Security headers configured
- [ ] Secrets in environment variables
- [ ] Input validation on all forms
- [ ] Output properly escaped
- [ ] SQL queries parameterized
- [ ] Authentication implemented
- [ ] Authorization checks in place
- [ ] Rate limiting configured
- [ ] Logging sensitive actions
- [ ] Error pages don't leak info

Let's start with HTTPS configuration.
